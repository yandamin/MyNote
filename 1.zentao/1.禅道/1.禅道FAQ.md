#### php 版本

```
windows一键安装包php版本可以在控制面板查看。
linux一键安装包可以使用命令 /opt/zbox/bin/php -v 查看php版本。
```



```
禅道PPT及学习视频 官方下载链接：http://dl.cnezsoft.com/zentao.zip
```



#### 常用文件文件夹

```shell
windows
	apache配置文件
	xampp/runner/res/apache/conf/httpd.conf
	xampp/apache/conf/httpd.conf
	
	php.ini:xampp/runner/res/php/php.ini

	mysql文件:zentao(pro/ep/pms)/config/my.php
	xampp/mysql/data/zentao

linux
	apache配置文件：/opt/zbox/etc/apache/httpd.conf
	php.ini:/opt/zbox/etc/php/php.ini
	mysql文件：/opt/zbox/app/zentaoep/db/
	zentao(pro/ep/pms)/config/my.php
	/opt/zbox/data/mysql/

备份 & 附件文件夹
    zentao(pms/ep/pro)/tmp/backup  /opt/zbox/app/zentao/tmp/backup
    zentao(pro/ep/pms)/www/data/upload/1
```

#### xxd

可以看下客户端集成文档:  https://www.zentao.net/book/zentaopmshelp/302.html

```
13:47:51 Uncaught LengthException: The ciphertext has an invalid padding length (0) compared to the block size (16) in lib/phpaes/phpseclib/Crypt/Common/SymmetricKey.php:1989
Stack trace:
#0 lib/phpaes/phpseclib/Crypt/Common/SymmetricKey.php(1386): SymmetricKey->unpad('')
#1 lib/phpaes/phpaes.class.php(33): SymmetricKey->decrypt('')
#2 framework/xuanxuan.class.php(357): phpAES->decrypt('')
#3 framework/xuanxuan.class.php(102): xuanxuan->decrypt('')
#4 framework/xuanxuan.class.php(44): xuanxuan->setInput()
x.php是提供给 xxd 的一个接口，这个报错是指 x.php 想要的是一个加密的数据，却收到浏览器传来的普通数据，所以报错，此报错并没有什么影响。

- xxd服务是否正常启动？截图看下。
- 截图看下服务端 xxd.conf 配置文件内容。
- 截图看下禅道软件 后台-客户端 - 参数页面内容。
- xxd.conf 中的 debug=2 然后重启xxd服务。
- 本机 telnet xxd服务端ip 11443 11444 端口截图看下通吗？（排除防火墙，端口问题）
- 客户端访问连接有添加http前缀吗？
- https://www.zentao.net/book/zentaopmshelp/302.html 看下手册的，第五步注意事项
截图看下 (zbox/etc/apache/httpd.conf) (xampp\apache\conf) 文件是否有 x.php 的配置 (配出升级版本,没有此配置)

xxd后台运行：nohup ./xxd &
```





```
【Mysql服务相关】【PDO】
windows一键安装包
1. 控制面板看下mysql的启动状态。
2. 截图看下 zentao/config/my.php 中数据库连接信息看下是否正确？

linux一键安装包
1. 执行命令：ps -ef | grep mysql 截图看下。
2. cat /opt/zbox/app/zentao/config/my.php 截图看下。

当前禅道服务所在主机是否部署过多套禅道或者有其他的mysql服务，更换个mysql服务端口试下。
1. 在系统-任务管理器 查看下mysqlzt服务 是否正常启动了？
2. 是否修改过默认密码？改回被修改密码试下。
```





#### 禅道安装过程中遇到的问题

```
企业版安装中第四步设置账号点击保存失败: 
1. 是不是源码包安装的 , 是否配置了 ioncube 扩展
2. 不导入 demo 数据试下
3. 删除数据库表数据和表结构,重新安装下
4. 安装的时候是使用的mysql的账号有删除表的操作权限吗?
5. debug 日志看下
6. apache 与 mysql的日志文件看下
```



#### 附件大小

```
windows一键安装包默认设置成50M，源码安装php默认是2M最大附件。
源码包安装 调整php.ini 中的 post_max_size 和 upload_max_filesize值，重启apache即可。
nginx 修改配置client_max_body_size参数。
上传文件过大可能会导致上传超时，限制30秒。
大附件，推荐使用共享文件或者网盘去管理，禅道中使用链接的方式引入下。（可以了解下我们的悦库网盘：http://www.ydisk.cn/）

附件上传看不见
1. 禅道版本是多少,右下角截图看下
2. 错误日志也看下
3. 上传的文件是什么格式, 多大? 
```



```
上传的图片看不到
1. 数据有做过数据迁移吗? 
```



```
zentao(pro/biz/pms)/config/my.php(db.php) 中debug的值改成true 重新操作一下, 看日志文件
zentao(pms/biz/pro)/tmp/log/php开头的今天的文件有什么报错。注：不要找sql开头的文件。
```



#### 多人任务  子任务

```
批量创建子任务的时候需要创建不同的名称,可以试一下创建事务类型的任务, 事务类型的任务可以指派多人的
相同的任务名称需要间隔1 分钟以上才可以重复创建.

多人任务是串行的,第一个人完成会默认指派给下一个人,如果多人同时执行的话,建议创建子任务
该任务是多人任务，多人任务是有自己的团队的。http://www.zentao.net/book/zentaopmshelp/86.html
多人任务：多人任务是串行，子任务是并行。

多人任务文档:
http://www.zentao.net/book/zentaopmshelp/130.html
http://www.zentao.net/book/zentaopmshelp/86.html

父子任务：父任务工时 = 子任务工时之和 子任务设置工时后, 父任务工时就会使用其子任务工时之和计算
```



```
windows一键安装包安装第二套禅道
前提：用禅道windows一键安装包安装好禅道，并能用网页正常访问。
1. 备份当前xampp包，可以直接拷贝一份进行备份。
2. 下载第二套禅道的对应版本的源码包（注意是源码包），解压到 xampp/htdocs/下面 得到 xampp/htdocs/zentaopms/ 目录。
3. 修改xampp/htdocs/zentaopms/config/config.php中的 sid 改成 zid。
4. 修改xampp/htdocs/zentaopms/www/.ztaccess 第8行中间部分 /zentao/index.php/$1 改成 /zentaopms/www/index.php/$1
5. 修改xampp/runner/res/apache/conf/httpd.conf 把89行 SetHandler text/plain 改成 SetHandler application/x-httpd-php
6. 网页访问ip:端口/zentaopms/www/install.php按照提示进行安装。注意数据库要和之前数据库名称不同（之前禅道默认用的数据库是zentao 或者 zentaopro）。

linux一键安装包安装第二套禅道
前提：用禅道linux一键安装包安装好禅道，并能用网页正常访问。
1、备份当前zbox包，可以直接拷贝一份进行备份。
2、下载第二套禅道的对应版本的源码包（注意是源码包），解压到 /opt/zbox/app/htdocs/下面 得到 /opt/zbox/app/htdocs/zentaopms/ 目录。
3、修改/opt/zbox/app/htdocs/zentaopms/config/config.php 中的 sid 改成 zid。
4、修改/opt/zbox/app/htdocs/zentaopms/www/.ztaccess 第8行中间部分 /zentao/index.php/$1 改成 /zentaopms/www/index.php/$1
5、网页访问 ip:端口/zentaopms/www/install.php 按照提示进行安装。注意数据库要和之前数据库名称不同（之前禅道默认用的数据库是zentao 或者 zentaopro）。
```



```
数据合并
两套禅道的数据是无法合并在一起的，需要专门的合并程序执行, 是需要收费的，需要的话可以联系商务同事咨询下。
数据合并这块需要研发部门同事进行操作。
```



```
apache 没有解析php文件
1. 看下浏览器的访问地址
2. 可以修改下apache的配置文件, 允许此目录下的文件被解析
3. windows 一键安装包有两个文件需要修改: xampp/apache/conf/httpd.conf   xampp/runner/res/apache/conf/httpd.conf
4. 修改apache 配置后需要重启下
```



```
telnet 服务器ip 禅道服务端口，截图看下。
windows 开启telnet 文档:  https://blog.csdn.net/qq_35428201/article/details/81048134
```



```
密码错误
1. 检查下磁盘空间是不是满了?
2. 检查一下 xampp中的mysql是否正常启动，不能确定的话可以运行 xampp/start.exe 重启一下服务看一下结果。
3. 检查一下 xampp/zentao/config/my.php 中的参数是否正确。


禅道忘记密码解决方案：二选一即可
管理员账号在登录页面点击忘记密码，其他用户使用管理员账号在组织 - 用户进行密码重置；
或者登录禅道数据库zt_user表，找到admin用户的记录，password改为 e10adc3949ba59abbe56e057f20f883e 登录密码就是 123456


数据库密码忘记（忘记原密码）
方式1：看下zentao/config/my.php 文件中的记录。
方式2：
1、停止禅道的服务，重命名xampp为xampp_bak。
2、重新安装相同版本禅道，保证页面可以正常访问。
3、迁移数据。注意数据库物理文件时，需要停止服务。
xampp_bak/zentao/www/data/upload/1/ 目录下内容拷贝到 /xampp/zentao/www/data/upload/1。
xampp_bak/mysql/data/zentao/ 目录下文件拷贝到 /xampp/mysql/data/zentao/ 下面。


windows 一键安装包修改数据库密码，前提知道原密码；
1. D:\xampp\mysql\bin > mysql -uroot -h 127.0.0.1 -P3306 -p // 一定要声明端口, 防止误连er
2. flush privileges; // 刷新权限
3. set password for root@localhost = password('123456');
4. 修改my.php文件中对应的密码字段。
```



```
如果一个需求属于多个模块, 可以将需求放在顶级模块下
```



```
http://www.zentao.net/book/zentaopmshelp/71.html
http://www.zentao.net/book/zentaopmshelp/60.html
禅道9.6.2.版本，新增了 受限操作权限分组 。
组织--权限--受限用户分组，维护分组成员时，属于该分组的 用户在禅道里 只能编辑与自己相关的 需求、任务、 bug等 ，不能新增 需求、任务、bug等。
受限用户只能编辑与自己相关的内容，包含指派给、已完成、已取消、已关闭、最后编辑，不包含抄送给的内容。
如果该用户之前不是受限用户，现在是受限用户。那么之前由他创建需求，任务，bug等，他都还有相关的操作权限。
比较适用于公司新来员工的权限设置，怕其不熟悉公司业务而导致误操作。
```





```
附件大小
windows一键安装包默认设置成50M，源码安装 php默认是2M最大附件。
源码包安装 调整php.ini 中的 post_max_size 和 upload_max_filesize值，重启apache即可，如果使用nginx还需要修改nginx 的配置client_max_body_size参数。
一键安装包的话可以修改zentao/www/.ztaccess  文件中的参数  post_max_size 和 upload_max_filesize值
上传文件过大可能会导致上传超时，限制30秒。特别大的附件可以存在网盘中，然后在禅道黏贴链。
```



```
转入任务
项目-任务 右上角点击按钮 导入-转入任务 。需要满足4个条件：
1、新的项目和老的项目必须关联同一个产品；
2、不能导入子任务；
3、任务状态是以下状态中的一种：未开始、进行中、暂停、取消；
4、如果任务关联了需求，那新的项目必须也关联这个需求所在的产品（如果是多平台/多分支产品，还需要新的项目关联了需求所在的平台/分支）
```



```
只需要在线查看可以集成下 libreOffice
需要在线编辑可以集成下 collabora office
相关文档：http://www.zentao.net/book/zentaobizhelp/267.html

libreOffice 配置保存卡顿，停止禅道服务，将soffice路径中soffice的后缀改为.com，如：D:\app\libreoffice\program\soffice.com

office 在线编辑目前没有权限控制，有下载权限的用户都可以点击查看。
镜像文件（不要使用ie下载）：
（只能virtualbox使用,如果导入报错网卡初始化失败_点击更改网卡然后直接点击ok_可以正常导入）http://dl.cnezsoft.com/zentao/package/centos73x64_root_123456_collabora.ova
（只能vmware使用，如果导入提示失败点击重试）http://dl.cnezsoft.com/zentao/package/centos73x64_root_123456_collabora.ovf.zip

企业版文档 collabora 集成功能
提示 “未授权的WOPI主机”
排查1：检查禅道和collbora office 主机的网络是否可以互通；
排查2：如果禅道后台配置的collabora office 的网址使用了域名：修改 collabora office 配置文件 /etc/loolwsd/loolwsd.xml 中的 第110行左右增加代码：<host desc="Regex pattern of hostname to *allow or deny." allow="true">.*</host> 保存后重启loolwsd服务后再试试。
排查3：检查zentao(pms/ep)/tmp/下面是否有 template文件夹，如果没有 把template.zip 解压后放到 zentao(pms/ep)/tmp/ 下面 并分配读写权限。
libreOffice 配置保存卡顿，停止禅道服务，将soffice路径中soffice的后缀改为.com，如：D:\app\libreoffice\program\soffice.com
提示 “未授权的WOPI主机”

权限:使用collbora office编辑查看文档时,无法设置附件文档的编辑,查看权限,collbora office 是第三方应用,目前禅道无法进行这里的权限配置.
```



```
文件导入, 批量导入

数据批量导入不成功
1. 贵公司有电脑上有加密程序吗?
2. 模板文件的必填项有填写吗? 必填项没有的话,禅道是不会读取这一行的数据的;

1. 批量导入的excel 表格文件日期单元格类型设置为文本类型, 禅道中日期是读取的文本格式数据
```



```
甘特图导出pdf不成功
1. 是ie浏览器导出吗? 不要使用ie浏览器使用谷歌火狐试下.
2. 错误日志看下
```



```
每日任务提醒会每天发送邮件提醒用户未完成的bug、需求、任务、测试单。 bug解决之后直接关闭即可。

【每日任务】提醒中提醒的任务需要符合以下条件
1、任务指派人不能为空；
2、任务不是删除状态；
3、指派人不是删除帐号；
4、任务的状态是未开始或者进行中；
5、任务所在项目的项目状态不能是暂停状态；
6、如果任务有设置截止日期，截止日期到期前3天开始进行通知，如果没有设置截止日期会直接通知。

每日提醒范围：指派给我的未关闭的bug、任务、待办 和 我负责的没有完成的测试单。
修改方式：后台 - 系统 -定时，修改每日任务提醒时间，修改参数后需要执行如下操作：后台-系统-定时 关闭 =》重启apache服务 =》 开启 后台-系统-定时
```



```
同步/异步  非异步
异步就是触发后,等待后台 - 系统 - 定时, 统一调用发信程序,好处是可以节省表单的提交时间,不需要等待发信过程执行, 缺点是每5分钟执行一次;
同步发信就是操作完立即发信, 缺点是需要等待发信程序执行完,才能执行继续操作禅道, 优点是立即收到邮件;
```



```
linux 内核问题
centos 8.0 内核 4.18 有问题 , apache 无法启动 ,777权限后 , 没有日志
kernel 不支持低Linux 2.6的内核, 页面登陆min.js 文件加载过慢, 没有日志
```



```
内存溢出
1. windows 一键安装包修改 xampp/php/php.ini 和 xampp/runner/res/php/php.ini 中memory_limit 参数值改成512M。
2. linux 一键安装包修改 /opt/zbox/etc/php/php.ini 中memory_limit 参数值改成512M。
2. 保存后重启服务生效。
3. 导入的时候，建议分批导入，一次不要导入太多的数据。
```



```
文档对比
1. 文本内容需要直接编辑修改在禅道文档中,如果是以附件的方式上传的word/excel文件, 这个是对比不了的;
2. 可以在文档 - 创建自定义文档库 - 创建文档, 然后再编辑此文档, 保存后这个文档就有2个版本了,可以在下方找到一个对比按钮,进行文档对比;
```



```
【升级】
建议升级到 11.6.5版本 10.6之前的版本已经停止支持。
升级到新版本该功能再试一下，升级前请做好数据备份。
升级请参考文档：http://www.zentao.net/book/zentaopmshelp/41.html
备份请参考文档：http://www.zentao.net/book/zentaopmshelp/42.html
```



```
LDAP
目前禅道和ldap同步 只能把用户信息同步到禅道中, 组织结构还没有同步功能
禅道和ldap功能现在分2个方面
1、组织-用户 从ldap中导入用户, 导入的时候 可以选择 导入哪些帐号
2、直接用ldap用户登录禅道 如果之前没有导入过 系统会自动创建相应的帐号

 ldap服务器 每次只能提供最多1000个帐号信息的，可以在禅道ldap配置页面修改 base dn 分别同步不同部门的用户数据
```



```
用例库作用：
一般公共的用例可以维护到用例库，用例库里的用例可以导入到多个产品下。
公共用例库可以把不同的测试模块，或者是测试功能点所引用到的测试用例做分类管理，这样可以有效提高测试用例的复用性。
用例库中的用例是可以导入到所有产品中的。主要适用于跨产品的用例，比如浏览器的兼容性测试，安全测试，性能测试。
测试经理可以把常见的一些分类，用例列举出来，来引导普通的测试人员来写用例。
```



```
产品线参考文档: http://www.zentao.net/book/zentaopmshelp/289.html
产品线就是对一类产品的分类, 类似产品下需求的模块;比如禅道这个产品线，下面包含禅道专业版，禅道开源版，禅道企业版。
```



```
任务关闭/不关闭
任务不关闭的话, 当查询指派给自己的任务时会有一堆的任务造成干扰, 而任务关闭的话会默认指派给close, 方便用户查看自己当前要完成的任务
```



```
Linux一键安装包访问mysql：文档：http://www.zentao.net/book/zentaopmshelp/90.html
windows一键安装包如何实现mysql异机连接：文档：http://www.zentao.net/book/zentaopmshelp/276.html

[ERROR] Can't init tc log
mysql报错日志有 tc.log 停止服务， /opt/zbox/data/mysql/目录下的tc.log删除下，启动服务试试。
```



```
需求状态，需求阶段，可以看下该文档 http://www.zentao.net/book/zentaopmshelp/92.html
```



```
反馈
可以编辑下产品 - 概况中的反馈负责人，当创建反馈的时候会默认指派给当前产品的反馈负责人，反馈形式包括邮件，短信，消息通知。

研发界面,默认情况下,有创建反馈的权限就可以看到所有产品的反馈 , 如果配置了反馈权限就只能查看有权限查看的产品 ; 
非研发界面, 非研发用户只能查看自己提交的反馈与公开的反馈
```



```
用例导入相关, 批量导入
导出模板在模板中添加数据后，导入即可，用例上传没有上传限制，如果数据较多建议分批多次上传，不支持分 sheet 页面上传。
```



































#### 统计功能介绍

```
需求的基本统计报表：http://www.zentao.net/book/zentaopmshelp/145.html
任务的基本统计报表：http://www.zentao.net/book/zentaopmshelp/120.html
自定义sql的介绍: http://www.zentao.net/book/zentaoprohelp/229.html
```



#### 统计报表

```
产品
产品汇总表：列出所有产品的计划，负责人，需求状态统计。主要列出每个产品的计划，以及计划下是否有未完成，未关闭的需求状态
产品路线图表：列出所有产品的发布版本和未过期计划。
产品投入表：列出每个产品的项目总数，以及消耗的工时。
产品完成度统计表：按照产品列出需求总数，完成的总数（状态是关闭或者研发阶段状态为发布），完成的百分比。
产品需求状态分布表：按照产品列出需求的总数、状态的分布情况。
产品需求阶段分布表：按照产品列出需求的总数、研发阶段的分布情况。
产品发布数量统计表：按照产品列出发布的数量。
产品质量表：列出产品的需求、bug状态统计信息。
产品Bug类型统计表：按照产品统计bug的类型分布情况。
产品Bug解决方案统计表：按照产品统计bug的解决方案分布情况。

项目
项目偏差报表：在起止时间内 , 已结束项目的项目情况
任务状态统计：按照项目统计任务的状态分布情况。
任务类型统计：按照项目统计任务的类型分布情况
项目任务指派统计：项目中所有任务的指派情况，如：A用户被指派了多少任务，多少任务没有指派（空），多少任务已经关闭（closed，这里的关闭不是完成，完成状态也是有指派者的，需要指派者验证任务完成情况，任务关闭为Closed）
项目任务完成者统计：表示该项目目前共多少任务已经完成，完成者是谁，谁开发任务，谁去完成，可用于统计每人完成量。
项目投入统计：按照项目列出工期、任务、需求数量、人数、总消耗工时
项目需求状态分布表：按照项目统计需求的状态分布情况
项目需求阶段分布表：按照项目列出需求的总数、研发阶段的分布情况
项目Bug状态分布表：按照项目统计bug的状态分布情况
项目Bug解决方案分布表：按照项目统计bug的解决方案分布情况
项目Bug创建者分布表：按照项目统计bug的创建者分布情况
项目bug解决者分布表：按照项目统计bug的解决者分布情况
项目bug指派给分布表：按照项目统计bug的指派给分布情况
项目质量表：列出项目的需求、任务、bug的总数及完成数，计算严重bug比例
项目进展表：展示所有项目的需求数、任务数、剩余工时总数，项目进度信息。
项目bug类型统计：按照项目统计bug的类型分布情况

测试
Bug创建表：按照创建者统计bug的解决方案及有效率
Bug指派表：按照被指派人统计bug在哪些产品下的数量
用例统计表：按照模块统计用例总数、执行结果、总执行数及用例通过率
用例执行统计表：按照测试单统计用例总数、执行结果及用例通过率
版本统计表：按照项目的版本统计bug的严重程度、类型、状态
需求关联bug汇总：
项目Bug状态分布表：按照项目统计bug的状态分布情况
项目Bug解决方案分布表：按照项目统计bug的解决方案分布情况
项目Bug创建者分布表：按照项目统计bug的创建者分布情况
项目Bug解决者分布表：按照项目统计bug的解决者分布情况
项目Bug指派给分布表：按照项目统计bug的指派给分布情况
产品需求状态分布表：按照产品列出需求的总数、状态的分布情况。
任务状态统计：按照项目统计任务的状态分布情况。
产品Bug类型统计表：按照产品统计bug的类型分布情况
产品Bug解决方案统计表：按照产品统计bug的解决方案分布情况
Bug解决表：列出解决的bug总数，解决方案的分布，占的比例（该用户解决的bug的数量占所有的解决的bug的数量）。
项目Bug类型统计表：按照项目统计bug类型的分布情况

组织
员工负载表：计算未来一段时间员工的工作负载情况, 工作负载= 总工时 / （工作日天数 * 每天工时）
任务完成汇总表：统计过去一段时间员工的任务消耗情况 2. 查看任务的延期情况
任务指派汇总表：按照指派给的角度统计任务消耗情况
Bug解决汇总表：按照bug解决者统计bug信息
Bug指派汇总表：按照bug指派统计bug信息
员工登录次数统计表：统计员工每人每天的登陆次数、总数
日志汇总：统计某个时间段内的日志情况，可以按部门选择
公司动态汇总：可以指定一个时期，列出相应数据


任务状态统计：按照项目统计任务的状态分布情况。
项目需求状态分布表：按照项目统计需求的状态分布情况
项目需求阶段分布表：按照项目列出需求的总数、研发阶段的分布情况

需求关联bug汇总：
项目Bug解决方案分布表：按照项目统计bug的解决方案分布情况
项目Bug创建者分布表：按照项目统计bug的创建者分布情况
项目Bug指派给分布表：按照项目统计bug的指派给分布情况
```

